-- Criação do banco de dados
CREATE DATABASE GERENCIAMENTO_FARMACIA;
GO

-- Selecionar o banco de dados para uso
USE GERENCIAMENTO_FARMACIA;
GO

-- Criação da tabela PAGAMENTO
CREATE TABLE PAGAMENTO (
    ID_PAGAMENTO INT PRIMARY KEY IDENTITY(1,1),
    DATA_PAGAMENTO DATE NOT NULL,
    VALOR DECIMAL(10,2) NOT NULL,
    METODO_PAGAMENTO VARCHAR(50) NOT NULL,
    ID_VENDA INT NOT NULL,
    CONSTRAINT FK_PAGAMENTO_VENDAS FOREIGN KEY (ID_VENDA) REFERENCES VENDAS(ID_VENDA)
);

-- Criação da tabela FUNCIONARIOS
CREATE TABLE FUNCIONARIOS (
    ID_FUNCIONARIO INT PRIMARY KEY IDENTITY(1,1),
    NOME VARCHAR(100) NOT NULL,
    CPF CHAR(11) NOT NULL UNIQUE,
    TELEFONE VARCHAR(15),
    SALRIO DECIMAL(10,2) NOT NULL,
    EMAIL VARCHAR(100),
    CARGO VARCHAR(50) NOT NULL,
    DATA_CONTRATACAO DATE NOT NULL
);

-- Criação da tabela VENDAS
CREATE TABLE VENDAS (
    ID_VENDA INT PRIMARY KEY IDENTITY(1,1),
    DATA_VENDA DATE NOT NULL,
    ID_CLIENTE INT,
    ID_FUNCIONARIO INT NOT NULL,
    VALOR_TOTAL DECIMAL(10,2) NOT NULL,
    CONSTRAINT FK_VENDAS_CLIENTES FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID_CLIENTE),
    CONSTRAINT FK_VENDAS_FUNCIONARIOS FOREIGN KEY (ID_FUNCIONARIO) REFERENCES FUNCIONARIOS(ID_FUNCIONARIO)
);

-- Criação da tabela ITENSVENDA
CREATE TABLE ITENSVENDA (
    ID_VENDA INT NOT NULL,
    ID_PRODUTO INT NOT NULL,
    QUANTIDADE INT NOT NULL,
    PRECO_UNITARIO DECIMAL(10,2) NOT NULL,
    CONSTRAINT PK_ITENSVENDA PRIMARY KEY (ID_VENDA, ID_PRODUTO),
    CONSTRAINT FK_ITENSVENDA_VENDAS FOREIGN KEY (ID_VENDA) REFERENCES VENDAS(ID_VENDA),
    CONSTRAINT FK_ITENSVENDA_PRODUTOS FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTOS(ID_PRODUTO)
);

-- Criação da tabela REGISTROARMAZENAMENTO
CREATE TABLE REGISTROARMAZENAMENTO (
    ID_REGISTRO INT PRIMARY KEY IDENTITY(1,1),
    DATA_REGISTRO DATE NOT NULL,
    ID_PRODUTO INT NOT NULL,
    QUANTIDADE INT NOT NULL,
    ID_FORNECEDOR INT NOT NULL,
    CONSTRAINT FK_REGISTRO_PRODUTOS FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTOS(ID_PRODUTO),
    CONSTRAINT FK_REGISTRO_FORNECEDOR FOREIGN KEY (ID_FORNECEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR)
);

-- Criação da tabela PRODUTOS
CREATE TABLE PRODUTOS (
    ID_PRODUTO INT PRIMARY KEY IDENTITY(1,1),
    NOME VARCHAR(100) NOT NULL,
    DESCRICAO VARCHAR(255),
    PRECO DECIMAL(10,2) NOT NULL,
    ID_CATEGORIA INT NOT NULL,
    CONSTRAINT FK_PRODUTOS_CATEGORIA FOREIGN KEY (ID_CATEGORIA) REFERENCES CATEGORIAPRODUTOS(ID_CATEGORIA)
);

-- Criação da tabela CATEGORIAPRODUTOS
CREATE TABLE CATEGORIAPRODUTOS (
    ID_CATEGORIA INT PRIMARY KEY IDENTITY(1,1),
    NOME VARCHAR(100) NOT NULL,
    DESCRICAO VARCHAR(255)
);

-- Criação da tabela CLIENTES
CREATE TABLE CLIENTES (
    ID_CLIENTE INT PRIMARY KEY IDENTITY(1,1),
    NOME VARCHAR(100) NOT NULL,
    ENDERECO VARCHAR(255),    
    CPF CHAR(11) NOT NULL UNIQUE,
    TELEFONE VARCHAR(15),
    EMAIL VARCHAR(100)
);

-- Criação da tabela RECEITASMEDICAS
CREATE TABLE RECEITASMEDICAS (
    ID_RECEITA INT PRIMARY KEY IDENTITY(1,1),
    ID_CLIENTE INT NOT NULL,
    ID_PRESCRICAO INT NOT NULL,
    DATA_RECEITA DATE NOT NULL,
    CONSTRAINT FK_RECEITA_CLIENTE FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES(ID_CLIENTE),
    CONSTRAINT FK_RECEITA_PRESCRICAO FOREIGN KEY (ID_PRESCRICAO) REFERENCES PRESCRICOES(ID_PRESCRICAO)
);

-- Criação da tabela CONTROLEESTOQUE
CREATE TABLE CONTROLEESTOQUE (
    ID_CONTROLE INT PRIMARY KEY IDENTITY(1,1),
    ID_PRODUTO INT NOT NULL,
    QUANTIDADE_ATUAL INT NOT NULL,
    DATA_ATUALIZACAO DATE NOT NULL,
    CONSTRAINT FK_CONTROLE_PRODUTOS FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTOS(ID_PRODUTO)
);

-- Criação da tabela ESTOQUE
CREATE TABLE ESTOQUE (
    ID_ESTOQUE INT PRIMARY KEY IDENTITY(1,1),
    ID_PRODUTO INT NOT NULL,
    QUANTIDADE_TOTAL INT NOT NULL,
    LOCALIZACAO VARCHAR(255),
    CONSTRAINT FK_ESTOQUE_PRODUTOS FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTOS(ID_PRODUTO)
);

-- Criação da tabela FORNECEDOR
CREATE TABLE FORNECEDOR (
    ID_FORNECEDOR INT PRIMARY KEY IDENTITY(1,1),
    NOME VARCHAR(100) NOT NULL,
    CNPJ CHAR(14) UNIQUE NOT NULL,
    TELEFONE VARCHAR(15),
    EMAIL VARCHAR(100),
    ENDERECO VARCHAR(255)
);

-- Criação da tabela PRESCRICOES
CREATE TABLE PRESCRICOES (
    ID_PRESCRICAO INT PRIMARY KEY IDENTITY(1,1),
    DESCRICAO VARCHAR(255) NOT NULL,
    DATA_PRESCRICAO DATE NOT NULL
);
